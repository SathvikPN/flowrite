{% extends "base.html" %}

{% block title %} {{ data.title }} {% endblock %}

{% block main %}
<div class="container pt-6">
    <form id="write-form" autocomplete="on">
        <textarea id="editor" name="content" 
                  placeholder="Start writing..." 
                  spellcheck="true"
                  autofocus></textarea>
        
        <div class="bottom-controls">
            <div class="controls-left">
                <select id="font-family" class="control-select">
                    <option value="system-ui">System UI</option>
                    <option value="inter">Inter</option>
                    <option value="georgia">Georgia</option>
                    <option value="times">Times New Roman</option>
                    <option value="helvetica">Helvetica</option>
                    <option value="arial">Arial</option>
                    <option value="menlo">Menlo</option>
                    <option value="monaco">Monaco</option>
                </select>
                <select id="font-size" class="control-select">
                    <option value="14">14px</option>
                    <option value="16" selected>16px</option>
                    <option value="18">18px</option>
                    <option value="20">20px</option>
                    <option value="24">24px</option>
                </select>
            </div>
            <button type="submit" class="btn btn-outline-secondary">Submit</button>
        </div>
    </form>
</div>

<style>
#write-form {
    display: flex;
    flex-direction: column;
    height: calc(100vh - 120px);
    position: relative;
}

#editor {
    flex: 1;
    width: 100%;
    padding: 2rem 0;
    margin: 0;
    font-size: 16px;
    line-height: 1.6;
    border: none;
    background: transparent;
    resize: none;
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    caret-color: #444444;
}

#editor:focus {
    outline: none;
}

#editor::placeholder {
    color: #999999;
    opacity: 0.6;
}

.bottom-controls {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    padding: 1rem 0;
    z-index: 100;
}

.controls-left {
    display: flex;
    gap: 1rem;
    margin-left: auto;
    margin-right: auto;
    width: 100%;
    max-width: var(--container-width, 750px);
    padding: 0 15px;
}

.control-select {
    appearance: none;
    -webkit-appearance: none;
    background-color: transparent;
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 6px;
    padding: 0.5rem 2rem 0.5rem 1rem;
    font-size: 14px;
    color: #444444;
    cursor: pointer;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%23666' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 12px;
    min-width: 140px;
}

.control-select:hover {
    border-color: rgba(0, 0, 0, 0.2);
}

.control-select:focus {
    outline: none;
    border-color: rgba(0, 0, 0, 0.3);
}

.btn {
    position: fixed;
    bottom: 1.5rem;
    right: 2rem;
}

/* Custom scrollbar */
#editor::-webkit-scrollbar {
    width: 8px;
}

#editor::-webkit-scrollbar-track {
    background: transparent;
}

#editor::-webkit-scrollbar-thumb {
    background-color: rgba(0, 0, 0, 0.1);
    border-radius: 4px;
}

#editor::-webkit-scrollbar-thumb:hover {
    background-color: rgba(0, 0, 0, 0.2);
}

@media (max-width: 768px) {
    #write-form {
        height: calc(100vh - 100px);
    }
    
    .controls-left {
        flex-wrap: wrap;
    }
    
    .control-select {
        flex: 1;
        min-width: 120px;
    }
}
</style>

<script>
const editor = document.getElementById('editor');
const fontFamily = document.getElementById('font-family');
const fontSize = document.getElementById('font-size');

// Font family mapping
const fonts = {
    'system-ui': 'system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif',
    'inter': 'Inter, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',
    'georgia': 'Georgia, serif',
    'times': '"Times New Roman", Times, serif',
    'helvetica': '"Helvetica Neue", Helvetica, Arial, sans-serif',
    'arial': 'Arial, sans-serif',
    'menlo': 'Menlo, Monaco, "Courier New", monospace',
    'monaco': 'Monaco, Consolas, "Courier New", monospace'
};

// Update font family
fontFamily.addEventListener('change', function() {
    const selectedFont = fonts[this.value];
    if (selectedFont) {
        editor.style.fontFamily = selectedFont;
        localStorage.setItem('preferred-font', this.value);
    }
});

// Update font size
fontSize.addEventListener('change', function() {
    const size = this.value;
    editor.style.fontSize = `${size}px`;
    localStorage.setItem('preferred-size', size);
});

// Load saved preferences
window.addEventListener('load', () => {
    const savedFont = localStorage.getItem('preferred-font');
    const savedSize = localStorage.getItem('preferred-size');
    
    if (savedFont && fonts[savedFont]) {
        fontFamily.value = savedFont;
        editor.style.fontFamily = fonts[savedFont];
    }
    
    if (savedSize) {
        fontSize.value = savedSize;
        editor.style.fontSize = `${savedSize}px`;
    }
    
    editor.focus();
});

// Keep focus on editor
editor.addEventListener('blur', () => {
    if (!document.querySelector('select:focus')) {
        setTimeout(() => editor.focus(), 10);
    }
});

// Prevent accidental navigation
window.addEventListener('beforeunload', (e) => {
    if (editor.value.trim().length > 0) {
        e.preventDefault();
        e.returnValue = '';
    }
});
</script>
{% endblock %}




<!-- create a container wide space for user to input writing. allow writing in markdown and render each line as user goes to next line. keep the background same as container and keep the cursor blinking. donot use box for form. form should blend in and donot have any box boundary. add a small secondary button to submit at bottom of page, fixed position to bottom of current window bottom. -->